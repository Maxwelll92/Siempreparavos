<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Shaiel ðŸŒ™</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;}

body{
font-family:-apple-system,BlinkMacSystemFont,sans-serif;
display:flex;
justify-content:center;
align-items:center;
min-height:100vh;
color:#eaf3ff;
transition:background 1s ease;
overflow:hidden;
}

body.day{background:linear-gradient(180deg,#1d3557,#457b9d);}
body.night{background:linear-gradient(180deg,#0f1c2e,#1b263b);}
body.storm{
background:linear-gradient(180deg,#0b0f1a,#141b2d);
animation:flash 7s infinite;
}

@keyframes flash{
0%,95%,100%{filter:brightness(1);}
96%{filter:brightness(1.8);}
97%{filter:brightness(.6);}
}

/* TARJETA CON TEXTURA Y PROFUNDIDAD */
.card{
width:400px;
padding:45px 30px;
border-radius:40px;
text-align:center;
position:relative;
overflow:hidden;

background:
radial-gradient(120% 120% at 20% 10%, rgba(255,255,255,0.08), transparent 60%),
radial-gradient(100% 100% at 80% 90%, rgba(0,0,0,0.25), transparent 60%),
linear-gradient(160deg,#1b2e47,#243f63 60%,#1b2e47);

box-shadow:
0 40px 80px rgba(0,0,0,0.55),
inset 0 0 40px rgba(255,255,255,0.04);
}

.card::before{
content:"";
position:absolute;
top:-50%;
left:-50%;
width:200%;
height:200%;
background:
radial-gradient(circle at 30% 40%, rgba(255,255,255,0.05), transparent 40%),
radial-gradient(circle at 70% 60%, rgba(255,255,255,0.04), transparent 40%);
animation:waveMove 18s infinite linear;
opacity:.6;
pointer-events:none;
}

@keyframes waveMove{
0%{transform:rotate(0deg);}
100%{transform:rotate(360deg);}
}

h1{font-size:26px;margin-bottom:6px;}
.location{font-size:13px;opacity:.7;margin-bottom:10px;}
.counter{font-size:12px;opacity:.6;margin-bottom:20px;}
.icon{font-size:36px;margin:5px 0;}
.main-temp{font-size:42px;font-weight:600;margin:10px 0 5px 0;}

.details{
display:grid;
grid-template-columns:1fr 1fr;
gap:10px;
margin-top:15px;
font-size:13px;
}

.detail-box{
background:rgba(255,255,255,0.05);
padding:10px;
border-radius:15px;
}

.moon-phase{margin-top:12px;font-size:13px;opacity:.85;}

.forecast{
display:flex;
justify-content:space-between;
margin-top:25px;
gap:6px;
}

.day{
background:rgba(255,255,255,0.05);
border-radius:18px;
padding:10px 6px;
font-size:11px;
flex:1;
}

.day.rain{background:rgba(0,150,255,0.15);}

.day-icon{font-size:16px;margin:4px 0;}
.rain-prob{font-size:10px;opacity:.85;}

.message{
margin-top:25px;
font-size:13px;
opacity:.85;
font-style:italic;
min-height:35px;
transition:opacity .6s ease;
}

.error{margin-top:10px;font-size:12px;color:#ffb3b3;}
</style>
</head>
<body class="night">

<div class="card">
<h1>Shaiel ðŸŒ™</h1>
<div class="location" id="location">Detectando ubicaciÃ³n...</div>
<div class="counter" id="counter"></div>

<div class="icon" id="mainIcon">â›…</div>
<div class="main-temp" id="mainTemp">--Â°</div>

<div class="details">
<div class="detail-box">ðŸŒ¡ SensaciÃ³n<br><span id="feels">--</span></div>
<div class="detail-box">ðŸ’§ Humedad<br><span id="humidity">--</span></div>
<div class="detail-box">ðŸ’¨ Viento<br><span id="wind">--</span></div>
<div class="detail-box">ðŸŒ§ Lluvia hoy<br><span id="rainToday">--</span></div>
</div>

<div class="moon-phase" id="currentMoon"></div>
<div class="forecast" id="forecast"></div>
<div class="message" id="message"></div>
<div class="error" id="error"></div>
</div>

<script>

/* CONTADOR EXACTO DESDE 30 ENERO 2026 */
const startDate = new Date(2026,0,30);

function updateCounter(){
const now = new Date();

let years = now.getFullYear() - startDate.getFullYear();
let months = now.getMonth() - startDate.getMonth();
let days = now.getDate() - startDate.getDate();

if(days < 0){
months--;
const lastMonth = new Date(now.getFullYear(), now.getMonth(), 0);
days += lastMonth.getDate();
}

if(months < 0){
years--;
months += 12;
}

document.getElementById("counter").innerText =
`${years} aÃ±os â€¢ ${months} meses â€¢ ${days} dÃ­as contigo`;
}
updateCounter();

/* FASE LUNAR */
function getMoonPhase(date){
const lp=2551443;
const new_moon=new Date(1970,0,7,20,35,0);
let phase=((date-new_moon)/1000)%lp;
if(phase<0)phase+=lp;
const index=Math.floor(phase/(lp/8));
const phases=[
["ðŸŒ‘","Luna Nueva"],
["ðŸŒ’","Creciente"],
["ðŸŒ“","Cuarto Creciente"],
["ðŸŒ”","Gibosa Creciente"],
["ðŸŒ•","Luna Llena"],
["ðŸŒ–","Gibosa Menguante"],
["ðŸŒ—","Cuarto Menguante"],
["ðŸŒ˜","Menguante"]
];
return phases[index];
}

/* ICONO CLIMA */
function getWeatherIcon(temp){
if(temp>=32)return"ðŸ”¥";
if(temp>=25)return"â˜€ï¸";
if(temp>=18)return"â›…";
if(temp>=10)return"ðŸŒ¥";
return"ðŸŒ§";
}

/* GEO */
function getLocation(){
navigator.geolocation.getCurrentPosition(
pos=>{
reverseGeocode(pos.coords.latitude,pos.coords.longitude);
getWeather(pos.coords.latitude,pos.coords.longitude);
},
()=>showError("Permiso de ubicaciÃ³n denegado.")
);
}

async function reverseGeocode(lat,lon){
try{
const res=await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}`);
const data=await res.json();
const city=data.address.city||data.address.town||data.address.village||"";
const suburb=data.address.suburb||data.address.neighbourhood||"";
document.getElementById("location").innerText=`ðŸ“ ${suburb}, ${city}`;
}catch{
document.getElementById("location").innerText="ðŸ“ UbicaciÃ³n desconocida";
}
}

let climateCategory="";

/* CLIMA */
async function getWeather(lat,lon){
const url=`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,apparent_temperature,relative_humidity_2m,wind_speed_10m,is_day&daily=temperature_2m_max,temperature_2m_min,precipitation_probability_max&timezone=auto`;

try{
const res=await fetch(url);
const data=await res.json();
updateWeather(data.current,data.daily);
renderForecast(data.daily);
setClimateCategory(data.current,data.daily);
generateMessages();
}catch{showError("No se pudo cargar el clima.");}
}

function updateWeather(c,d){

let storm = d.precipitation_probability_max[0]>70 && c.wind_speed_10m>35;

if(storm){
document.body.className="storm";
}else{
document.body.className=c.is_day?"day":"night";
}

document.getElementById("mainTemp").innerText=Math.round(c.temperature_2m)+"Â°";
document.getElementById("mainIcon").innerText=getWeatherIcon(c.temperature_2m);
document.getElementById("feels").innerText=Math.round(c.apparent_temperature)+"Â°";
document.getElementById("humidity").innerText=c.relative_humidity_2m+"%";
document.getElementById("wind").innerText=Math.round(c.wind_speed_10m)+" km/h";
document.getElementById("rainToday").innerText=d.precipitation_probability_max[0]+"%";

let moon=getMoonPhase(new Date());
document.getElementById("currentMoon").innerText=`${moon[0]} ${moon[1]}`;
}

function renderForecast(d){
let html="";
for(let i=1;i<=5;i++){
let date=new Date(d.time[i]);
let rain=d.precipitation_probability_max[i];
let moon=getMoonPhase(date);
html+=`
<div class="day ${rain>40?'rain':''}">
${date.toLocaleDateString("es-AR",{weekday:"short"})}
<div class="day-icon">${getWeatherIcon(d.temperature_2m_max[i])}</div>
${Math.round(d.temperature_2m_max[i])}Â°
<br><small>${Math.round(d.temperature_2m_min[i])}Â°</small>
<div class="rain-prob">ðŸŒ§ ${rain}%</div>
<div class="rain-prob">${moon[0]}</div>
</div>`;
}
document.getElementById("forecast").innerHTML=html;
}

/* MENSAJES POR CLIMA */
const messages={
warm:["El calor del dÃ­a se sienteâ€¦ pero no tanto como cuando te pienso.","El sol caeâ€¦ pero mi deseo no."],
mild:["Todo estÃ¡ en calmaâ€¦ como cuando tu mano toca la mÃ­a.","El aire es suaveâ€¦ como lo que guardo por ti."],
rain:["La lluvia caeâ€¦ y todo se vuelve mÃ¡s Ã­ntimo.","El mundo se mojaâ€¦ pero yo solo quiero acercarme mÃ¡s."],
storm:["La tormenta ruge afueraâ€¦ pero lo intenso estÃ¡ aquÃ­ dentro.","RelÃ¡mpagos arribaâ€¦ fuego debajo de mi piel."],
night:["La noche se abreâ€¦ y me invita a pensarte despacio.","Hay silencios que solo tÃº sabes llenar."],
cold:["El aire es frÃ­oâ€¦ pero tu recuerdo abriga.","Cuando todo se enfrÃ­aâ€¦ pienso en calor compartido."]
};

function setClimateCategory(c,d){
if(d.precipitation_probability_max[0]>70 && c.wind_speed_10m>35){climateCategory="storm";}
else if(d.precipitation_probability_max[0]>50){climateCategory="rain";}
else if(c.temperature_2m>=30){climateCategory="warm";}
else if(c.temperature_2m>=18){climateCategory="mild";}
else if(!c.is_day){climateCategory="night";}
else{climateCategory="cold";}
}

let msgIndex=0;
function generateMessages(){rotateMessage();}
function rotateMessage(){
const msg=document.getElementById("message");
msg.style.opacity=0;
setTimeout(()=>{
let arr=messages[climateCategory];
msg.innerText=arr[msgIndex];
msg.style.opacity=1;
msgIndex=(msgIndex+1)%arr.length;
},600);
}

setInterval(rotateMessage,30000);

function showError(text){
document.getElementById("error").innerText=text;
}

getLocation();
</script>
</body>
</html>
